console.log('oui');
$(document).ready(function(){
	$oldStatus = null;
	$nowStatus = null;
	$oldGrid = [];
	$nowGrid = [];
	$gameBoard = $("#game-board");
	$partyId = $("#party-id").html();
	setInterval( function() {

		$.ajax({
			// Ajax request every 1.5s to check the status of the game
			// It will switch the front for all player how are on the page if status change
			url: '/tictactoe/tictactoes/1/get_status?id=' + $partyId,
			type: "GET",
			success: function(data) {
				// Create a variable with html content
				let doc = document.documentElement.cloneNode();
				// Copy the content of data in doc the have it like html
				doc.innerHTML = data;
				// Select the html in the div of the page
				$oldStatus = $(doc.querySelector('#status')).html();

				if ($oldStatus == 1){
					if() {
					}

					getGrid();
				}

				checkStatus($oldStatus);
			}
		});
	}, 1500);
});

function checkStatus(status){
	// Check if status change or not
	if (status != $nowStatus) {
			$nowStatus = status;
			changeStatus($nowStatus);
		}
}

function getGrid(){
	// Check if the grid as changed
	$.ajax({
		url: '/tictactoe/tictactoes/1/get_grid?id=' + $partyId,
		type: "GET",
		success: function(data) {
			let doc = document.documentElement.cloneNode();
			doc.innerHTML = data;
			$oldGrid[0] = $(doc.querySelector('#player')).html();
			$oldGrid[1] = $(doc.querySelector('#a1')).html();
			$oldGrid[2] = $(doc.querySelector('#a2')).html();
			$oldGrid[3] = $(doc.querySelector('#a3')).html();
			$oldGrid[4] = $(doc.querySelector('#b1')).html();
			$oldGrid[5] = $(doc.querySelector('#b2')).html();
			$oldGrid[6] = $(doc.querySelector('#b3')).html();
			$oldGrid[7] = $(doc.querySelector('#c1')).html();
			$oldGrid[8] = $(doc.querySelector('#c2')).html();
			$oldGrid[9] = $(doc.querySelector('#c3')).html();
			checkGrid();
		}
	});
}

function checkGrid(){
	if ($oldGrid != $nowGrid){
		changeGrid();
	}
}

function changeGrid() {
	for (let x = 1; x <= 9; x++) {
		if ($oldGrid[x] != $nowGrid[x]) {
			$('#case-' + x).append($oldGrid[x]);
			$nowGrid[x] = $oldGrid[x];
		}
	}
}